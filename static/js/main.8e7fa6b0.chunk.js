(this.webpackJsonpwhatsappclone=this.webpackJsonpwhatsappclone||[]).push([[0],{103:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),o=a(19),r=a.n(o),l=(a(66),a(3)),i=(a(67),a(68),a(25)),s=a.n(i),u=s.a.initializeApp({apiKey:"AIzaSyA738-i7L9iXa9pfu9anu8IrLRFnu9yXAI",authDomain:"whatsappclone-1b4fd.firebaseapp.com",databaseURL:"https://whatsappclone-1b4fd.firebaseio.com",projectId:"whatsappclone-1b4fd",storageBucket:"whatsappclone-1b4fd.appspot.com",messagingSenderId:"541186087806",appId:"1:541186087806:web:8f8398e7750f5ddf20312f"}).firestore(),d=s.a.auth(),m=new s.a.auth.GoogleAuthProvider;m.setCustomParameters({prompt:"select_account"});var f=u,h=a(5),p=a(55),E=a.n(p),v=a(37),b=a.n(v),g=a(21),y=a(36),O=a.n(y),j=a(54),w=a.n(j),N=a(33),S=a.n(N),C=a(35),x=a.n(C);var I=function(e){var t=e.result,a=Object(n.useState)(null),o=Object(l.a)(a,2),r=o[0],i=o[1],s=Object(n.useState)(!1),u=Object(l.a)(s,2),d=u[0],m=u[1],p=Object(n.useState)(null),E=Object(l.a)(p,2),v=E[0],b=E[1],y=Object(n.useState)(f.collection("rooms")),j=Object(l.a)(y,2),N=j[0],C=(j[1],Object(n.useState)(null)),I=Object(l.a)(C,2),k=I[0],_=I[1],q=Object(h.c)((function(e){return e.login.user}));console.log("rerendering"),Object(n.useEffect)((function(){N.where("from.uid","==",t.uid).where("to.uid","==",q.uid).onSnapshot((function(e){var a=0;e.docChanges().forEach((function(e){b(e.doc.id),i(!0),_(e.doc.data().status),a++})),0===a&&N.where("from.uid","==",q.uid).where("to.uid","==",t.uid).onSnapshot((function(e){e.docChanges().forEach((function(e){b(e.doc.id),m(!0),_(e.doc.data().status)}))}))}))}),[]);var R=function(e){N.doc(v).update({status:e}).then((function(a){var n=f.collection("userRooms");"accepted"===e&&(n.add({uid:t.uid,roomId:v}),n.add({uid:q.uid,roomId:v}))})).catch((function(e){}))};return c.a.createElement("div",{className:"emailResults"},c.a.createElement("div",{className:"emailIcon"},c.a.createElement(O.a,null)),c.a.createElement("div",{className:"emailAddress",style:{flex:1}},c.a.createElement("div",{style:{fontSize:"18px"}},t.email),function(){if("requested"===k){if(r)return c.a.createElement("div",{style:{color:"grey"}},"Requested to chat with you");if(d)return c.a.createElement("div",{style:{color:"grey"}},"Request raised")}else{if("accepted"===k)return c.a.createElement("div",{style:{color:"grey"}},"Friends");if("rejected"===k)return c.a.createElement("div",{style:{color:"grey"}},"Rejected")}}()),"requested"!==k?"rejected"===k||"accepted"===k?c.a.createElement("div",null,""):c.a.createElement("div",{className:"sendRequest",onClick:function(){return function(e){var t={status:"requested",from:null,to:null},a={uid:q.uid,displayName:q.displayName,email:q.email};t.from=Object(g.a)({},a),t.to=Object(g.a)({},e),N.add(t).then((function(e){})).catch((function(e){}))}(t)}},c.a.createElement(w.a,null)):r?c.a.createElement("div",null,c.a.createElement("div",{className:"request",onClick:function(){return R("accepted")}},c.a.createElement(S.a,null)),c.a.createElement("div",{className:"request",onClick:function(){return R("rejected")}},c.a.createElement(x.a,null))):d?c.a.createElement("div",null,""):void 0)},k=function(e){var t=e.title;return c.a.createElement("div",{style:{fontSize:"30px",marginBottom:"20px",fontWeight:"600"}},t)};var _=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),a=t[0],o=t[1],r=Object(n.useState)([]),i=Object(l.a)(r,2),s=i[0],u=i[1],d=Object(n.useState)(!1),m=Object(l.a)(d,2),h=m[0],p=m[1];return c.a.createElement("div",{style:{padding:"15px 15px"}},c.a.createElement(k,{title:"Search"}),c.a.createElement("div",{className:"sidebar__searchContainer"},c.a.createElement(b.a,null),c.a.createElement("form",null,c.a.createElement("input",{placeholder:"Enter email to search",value:a,onChange:function(e){return o(e.target.value)}}),c.a.createElement("button",{onClick:function(e){e.preventDefault(),f.collection("users").where("email","==",a).get().then((function(e){if(e.empty)p(!0);else{var t=[];e.forEach((function(e){t.push({id:e.id,newDoc:e.data()})})),u(t),p(!1)}})).catch((function(e){console.log("Error getting documents: ",e)}))}},"search"))),h?c.a.createElement("div",{style:{color:"#fd2e2e",fontWeight:"bold"}},"This email does not exist"):"",c.a.createElement("div",{style:{marginTop:"15px",fontFamily:"sans-serif",color:"#515050"}},"PEOPLE"),0!==s.length?s.map((function(e){return c.a.createElement(I,{key:e.id,result:e.newDoc})})):"")},q=a(57),R=a.n(q),D=a(56),A=a.n(D);var z=function(e){var t,a=e.requestdetail,o=Object(n.useState)(f.collection("rooms")),r=Object(l.a)(o,2),i=r[0],s=(r[1],function(e,t){console.log(t),i.doc(t.id).update({status:e}).then((function(a){var n=f.collection("userRooms");"accepted"===e&&(n.add({uid:t.newDoc.from.uid,roomId:t.id}),n.add({uid:t.newDoc.to.uid,roomId:t.id}))})).catch((function(e){}))});return c.a.createElement("div",{className:"emailResults"},c.a.createElement("div",{className:"emailIcon"},c.a.createElement(O.a,null)),c.a.createElement("div",{className:"emailAddress",style:{flex:1}},c.a.createElement("div",{style:{fontSize:".9375rem"}},"".concat(a.newDoc.from.email," "),c.a.createElement("span",{style:{color:"grey"}},"requested"===a.newDoc.status?"Has requested to be your friend":"Friends"))),(t=a,c.a.createElement("div",null,c.a.createElement("div",{className:"request",onClick:function(){return s("accepted",t)}},c.a.createElement(S.a,null)),c.a.createElement("div",{className:"request",onClick:function(){return s("rejected",t)}},c.a.createElement(x.a,null)))))},T=function(){var e=Object(n.useState)(f.collection("rooms")),t=Object(l.a)(e,2),a=t[0],o=(t[1],Object(n.useState)([])),r=Object(l.a)(o,2),i=r[0],s=r[1],u=Object(h.c)((function(e){return e.login.user.uid}));Object(n.useEffect)((function(){a.where("status","==","requested").where("to.uid","==",u).onSnapshot((function(e){s(e.docs.map((function(e){return{id:e.id,newDoc:e.data()}})))}))}),[a,u]);return c.a.createElement("div",{style:{padding:"15px 15px"}},c.a.createElement(k,{title:"Requests"}),0===i.length?c.a.createElement("div",{style:{textAlign:"center",padding:"15px 0px"}},"No requests yet"):i.map((function(e){return c.a.createElement(z,{key:e.id,requestdetail:e})})))},B=a(119),F=(a(84),function(e){var t=e.chat,a=Object(n.useState)(null),o=Object(l.a)(a,2),r=o[0],i=o[1],s=Object(h.c)((function(e){return e.login.user.uid})),u=t.data;Object(n.useEffect)((function(){f.collection("userRooms").where("roomId","==",u.roomId).where("uid","!=",s).onSnapshot((function(e){var t=e.docs.map((function(e){return e.data().uid}));t[0]&&f.collection("users").where("uid","==",t[0]).onSnapshot((function(e){i(e.docs.map((function(e){return e.data()}))[0])}))}))}),[u.roomId,s]);var d=Object(h.b)();return r?c.a.createElement("div",{className:"navchat",onClick:function(){d({type:"selectedtochat",payload:{roomId:u.roomId,detailsOfFriend:r}})}},c.a.createElement("div",{style:{flex:1}},c.a.createElement("div",{style:{display:"flex",marginBottom:"8px"}},c.a.createElement("div",{style:{flex:"1",fontSize:"17px",fontWeight:"700"}},r?r.displayName:""),c.a.createElement("div",{style:{fontSize:"13px",position:"relative",top:"4px",color:"#aab0b7"}},"10:43 pm")),c.a.createElement("div",{style:{color:"#707479",fontSize:"15px"}},"Hello How are you"))):""});var H=function(){Object(h.b)();var e=Object(n.useState)(f.collection("rooms")),t=Object(l.a)(e,2),a=t[0],o=(t[1],Object(n.useState)([])),r=Object(l.a)(o,2),i=r[0],s=r[1],u=Object(h.c)((function(e){return e.login.user.uid}));return Object(n.useEffect)((function(){f.collection("userRooms").where("uid","==",u).onSnapshot((function(e){s(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[a,u]),c.a.createElement("div",{style:{padding:"15px 15px"}},c.a.createElement(k,{title:"chats"}),0!==i.length?i.map((function(e){return c.a.createElement(F,{key:e.id,chat:e})})):c.a.createElement("div",{style:{textAlign:"center",padding:"15px 0px"}},"Search someone to chat with"))},W=function(e){var t=f.collection("rooms"),a=Object(n.useState)(0),o=Object(l.a)(a,2),r=o[0],i=o[1],s=Object(n.useState)("chat"),u=Object(l.a)(s,2),m=u[0],p=u[1],v=Object(h.b)(),g=Object(h.c)((function(e){return e.login.user}));Object(n.useEffect)((function(){var e=t.where("status","==","requested").where("to.uid","==",g.uid).onSnapshot((function(e){i(e.size);var t=[];e.docChanges().forEach((function(e){console.log("change"),t.push({id:e.doc.id,newDoc:e.doc.data()})}))}));return function(){e()}}),[t,g.uid]);var y=function(e){p(e)};return c.a.createElement("div",{className:"sidebar"},c.a.createElement("div",{className:"sidebar__options"},c.a.createElement("div",{style:{color:"chat"===m?"#1a73e8":""},className:"navitem",onClick:function(){return y("chat")}},c.a.createElement(E.a,null)),c.a.createElement("div",{style:{color:"search"===m?"#1a73e8":""},className:"navitem",onClick:function(){return y("search")}},c.a.createElement(b.a,null)),c.a.createElement("div",{style:{color:"requests"===m?"#1a73e8":""},className:"navitem",onClick:function(){return y("requests")}},c.a.createElement(B.a,{badgeContent:r,color:"primary"},c.a.createElement(A.a,null))),c.a.createElement("div",{style:{marginTop:"auto"},className:"navitem",onClick:function(){return d.signOut().then((function(){v({type:"logout",payload:null})}),(function(e){}))}},c.a.createElement(R.a,null))),c.a.createElement("div",{className:"sidebar__chats"},function(){switch(m){case"chat":return c.a.createElement(H,null);case"search":return c.a.createElement(_,null);case"requests":return c.a.createElement(T,null);default:return c.a.createElement(H,null)}}()))};a(85);var P=function(e){var t=e.message,a=Object(h.c)((function(e){return e.login.user.uid}));return Object(n.useEffect)((function(){document.getElementsByClassName("allmessageshow")[0].scrollTo(0,document.getElementsByClassName("allmessageshow")[0].scrollHeight)}),[]),c.a.createElement("div",{className:"chat__message ".concat(t.user.uid==a?"chat__sender":"")},t.message,c.a.createElement("span",{className:"chat__timestamp"},"".concat((new Date).getHours(),":").concat((new Date).getMinutes())))},L=(a(86),function(e){var t=e.roomId,a=Object(n.useState)([]),o=Object(l.a)(a,2),r=o[0],i=o[1],s=Object(n.useRef)(null);return Object(n.useEffect)((function(){f.collection("rooms").doc(t).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){i(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[t]),console.log(r),c.a.createElement("div",{className:"chat__body"},c.a.createElement("div",{className:"allmessageshow",ref:s},0!==r.length?r.map((function(e){return c.a.createElement(P,{key:e.id,message:e.data})})):""))}),G=function(e){var t=e.chatInfo,a=Object(h.c)((function(e){return e.login.user})),o=Object(n.useState)(""),r=Object(l.a)(o,2),i=r[0],u=r[1];return c.a.createElement(n.Fragment,null,c.a.createElement("div",{className:"chat__header"},c.a.createElement("div",{className:"chat__headerInfo"},c.a.createElement("h3",{style:{color:"black"}},t.detailsOfFriend.displayName),c.a.createElement("div",{style:{fontWeight:"100",fontSize:"13px",marginTop:"5px",color:"#bebebe"}},"last seen today at 11:07 AM"))),c.a.createElement(L,{roomId:t.roomId}),c.a.createElement("div",{className:"chat__footer"},c.a.createElement("form",null,c.a.createElement("input",{type:"text",placeholder:"Type a message",name:"message",value:i,onChange:function(e){return u(e.target.value)}}),c.a.createElement("button",{type:"submit",onClick:function(e){e.preventDefault(),f.collection("rooms").doc(t.roomId).collection("messages").add({message:i,user:{uid:a.uid,email:a.email,displayName:a.displayName},timestamp:s.a.firestore.FieldValue.serverTimestamp()}).then((function(e){document.getElementsByClassName("allmessageshow")[0].scrollTo(0,document.getElementsByClassName("allmessageshow")[0].scrollHeight),u("")}))}},"Send message"))))},M=function(){var e=Object(h.c)((function(e){return e.selectChat.selectedChat}));return c.a.createElement("div",{className:"chat"},e?c.a.createElement(G,{chatInfo:e}):c.a.createElement("div",{style:{color:"#bbb7b7",fontSize:"30px"}},"Please select a chat to continue"))},J=a(120);var X=function(e){var t=Object(h.b)();return c.a.createElement("div",null,c.a.createElement(J.a,{variant:"contained",color:"primary",onClick:function(){d.signInWithPopup(m).then((function(e){var a=f.collection("users");a.where("email","==",e.user.email).get().then((function(n){var c=0;n.forEach((function(e){c++})),0===c?a.add({uid:e.user.uid,email:e.user.email,displayName:e.user.displayName}).then((function(a){t({type:"login",payload:e.user})})).catch((function(e){})):t({type:"login",payload:e.user})})).catch((function(e){}))})).catch((function(e){return alert(e)}))}},"SIGN WITH GOOGLE TO CHAT"))};var K=function(){var e=Object(h.b)(),t=Object(n.useState)(null),a=Object(l.a)(t,2),o=a[0],r=a[1];Object(n.useEffect)((function(){d.onAuthStateChanged((function(t){e(t?{type:"login",payload:t}:{type:"login",payload:null})}))}),[]);var i=Object(h.c)((function(e){return e.login.user}));return c.a.createElement("div",{className:"app"},i?c.a.createElement("div",{className:"app__body"},c.a.createElement(W,{selectChat:function(e){return r(e)}}),c.a.createElement(M,{selectedChatInfo:o})):c.a.createElement(X,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var U=a(23),V=Object(U.c)({login:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{user:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"login":return Object(g.a)(Object(g.a)({},e),{},{user:t.payload});default:return e}},selectChat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{selectedChat:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"selectedtochat":return Object(g.a)(Object(g.a)({},e),{},{selectedChat:t.payload});default:return e}}}),$=function(e,t){return"logout"===t.type&&(e=void 0),V(e,t)},Q=a(58),Y=Object(U.d)($,Object(U.a)(Q.a));r.a.render(c.a.createElement(h.a,{store:Y},c.a.createElement(c.a.StrictMode,null,c.a.createElement(K,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},61:function(e,t,a){e.exports=a(103)},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){}},[[61,1,2]]]);
//# sourceMappingURL=main.8e7fa6b0.chunk.js.map